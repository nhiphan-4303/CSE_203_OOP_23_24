/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package oop.lab7;

import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.ArrayList;
import javax.swing.ButtonGroup;
import javax.swing.JOptionPane;

/**
 *
 * @author hanie
 */
public class NewCDForm extends javax.swing.JFrame {

    private CD_list cdList = new CD_list();

    /**
     * Creates new form NewCDForm
     */
    public NewCDForm() {
        initComponents();

        setLocationRelativeTo(null);

        loadCDs();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        buttonGroup1 = new javax.swing.ButtonGroup();
        cdIdLabel = new javax.swing.JLabel();
        cdTitleLabel = new javax.swing.JLabel();
        jLabel4 = new javax.swing.JLabel();
        cdCollectionCmb = new javax.swing.JComboBox<>();
        cdTypeLabel = new javax.swing.JLabel();
        vcdRadioBtn = new javax.swing.JRadioButton();
        cdRadioBtn = new javax.swing.JRadioButton();
        cdPriceLabel = new javax.swing.JLabel();
        cdPriceTxt = new javax.swing.JTextField();
        cdYearLabel = new javax.swing.JLabel();
        cdYearTxt = new javax.swing.JTextField();
        addBtn = new javax.swing.JButton();
        clearBtn = new javax.swing.JButton();
        showBtn = new javax.swing.JButton();
        cdIdTxt = new javax.swing.JTextField();
        cdTitleTxt = new javax.swing.JTextField();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        getContentPane().setLayout(new java.awt.GridBagLayout());

        cdIdLabel.setText("CD ID");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 6;
        gridBagConstraints.ipady = 12;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(18, 57, 0, 0);
        getContentPane().add(cdIdLabel, gridBagConstraints);

        cdTitleLabel.setText("CD Title");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 3;
        gridBagConstraints.ipadx = 19;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(21, 57, 0, 0);
        getContentPane().add(cdTitleLabel, gridBagConstraints);

        jLabel4.setText("CD Collections");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 4;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(31, 57, 0, 0);
        getContentPane().add(jLabel4, gridBagConstraints);

        cdCollectionCmb.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Game", "Movie", "Music", " " }));
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 11;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(28, 27, 0, 0);
        getContentPane().add(cdCollectionCmb, gridBagConstraints);

        cdTypeLabel.setText("CD Type");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 12;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.ipadx = 15;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(31, 96, 0, 0);
        getContentPane().add(cdTypeLabel, gridBagConstraints);

        buttonGroup1.add(vcdRadioBtn);
        vcdRadioBtn.setText("VCD");
        vcdRadioBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                vcdRadioBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 14;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 26;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(29, 58, 0, 0);
        getContentPane().add(vcdRadioBtn, gridBagConstraints);

        buttonGroup1.add(cdRadioBtn);
        cdRadioBtn.setText("CD");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 16;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 35;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(29, 20, 0, 82);
        getContentPane().add(cdRadioBtn, gridBagConstraints);

        cdPriceLabel.setText("CD Price");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.ipadx = 3;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(39, 57, 0, 0);
        getContentPane().add(cdPriceLabel, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 11;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 473;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(36, 27, 0, 82);
        getContentPane().add(cdPriceTxt, gridBagConstraints);

        cdYearLabel.setText("CD Year Of Release");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 7;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 11;
        gridBagConstraints.ipady = 8;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(38, 57, 0, 0);
        getContentPane().add(cdYearLabel, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 11;
        gridBagConstraints.gridy = 8;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.ipadx = 473;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(39, 27, 0, 82);
        getContentPane().add(cdYearTxt, gridBagConstraints);

        addBtn.setText("Add");
        addBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                addBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.gridwidth = 8;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(75, 1, 135, 0);
        getContentPane().add(addBtn, gridBagConstraints);

        clearBtn.setText("Clear");
        clearBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 12;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(75, 63, 135, 0);
        getContentPane().add(clearBtn, gridBagConstraints);

        showBtn.setText("Show All");
        showBtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                showBtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 15;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(75, 9, 135, 0);
        getContentPane().add(showBtn, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 11;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.ipadx = 473;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(21, 27, 0, 82);
        getContentPane().add(cdIdTxt, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 11;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.gridwidth = 6;
        gridBagConstraints.gridheight = 2;
        gridBagConstraints.ipadx = 473;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.NORTHWEST;
        gridBagConstraints.insets = new java.awt.Insets(18, 27, 0, 82);
        getContentPane().add(cdTitleTxt, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void showBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_showBtnActionPerformed
        new CD_Store().setVisible(true);
    }//GEN-LAST:event_showBtnActionPerformed

    private void vcdRadioBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_vcdRadioBtnActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_vcdRadioBtnActionPerformed

    public void saveCDs() {
        try (ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream("CDs.dat"))) {
            oos.writeObject(cdList.getCdList()); // Save only the ArrayList<CD>
        } catch (IOException e) {
            JOptionPane.showMessageDialog(this, "Error saving CDs to file: " + e.getMessage());
        }
    }

    public void loadCDs() {
        try (ObjectInputStream ois = new ObjectInputStream(new FileInputStream("CDs.dat"))) {
            cdList.setCdList((ArrayList<CD>) ois.readObject());
        } catch (IOException | ClassNotFoundException e) {
            JOptionPane.showMessageDialog(this, "Error loading CDs from file.");
        }
    }
    private void addBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_addBtnActionPerformed
        String id = cdIdTxt.getText();
        String title = cdTitleTxt.getText();
        String collection = cdCollectionCmb.getSelectedItem().toString();
        vcdRadioBtn.setActionCommand("VCD");
        cdRadioBtn.setActionCommand("CD");
        String type = "";
        if (vcdRadioBtn.isSelected()) {
            type = vcdRadioBtn.getActionCommand();
        } else if (cdRadioBtn.isSelected()) {
            type = cdRadioBtn.getActionCommand();
        }
        String priceStr = cdPriceTxt.getText();
        String yearOfRelease = cdYearTxt.getText();

        try {
            double price = Double.parseDouble(priceStr);
            int year = Integer.parseInt(yearOfRelease);

            if (!id.isEmpty() && !title.isEmpty()) {
                if (vcdRadioBtn.isSelected()) {
                    type = "VCD";
                } else if (cdRadioBtn.isSelected()) {
                    type = "CD";
                }
                if (cdCollectionCmb.getSelectedIndex() != -1) {
                    collection = (String) cdCollectionCmb.getItemAt(cdCollectionCmb.getSelectedIndex());
                }
                CD cd = new CD(id, collection, type, title, price, year);
                cdList.getCdList().add(cd);
                JOptionPane.showMessageDialog(this, "Add successful.");
                saveCDs();
            } else {
                JOptionPane.showMessageDialog(this, "CD ID and CD Title can not be empty.");
            }

        } catch (NumberFormatException ex) {
            JOptionPane.showMessageDialog(this, "CD Price and CD Year of Release must be numbers.");

        }
    }//GEN-LAST:event_addBtnActionPerformed

    private void clearBtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clearBtnActionPerformed
        cdIdTxt.setText("");
        cdTitleTxt.setText("");
        cdPriceTxt.setText("");
        cdYearTxt.setText("");

        cdCollectionCmb.setSelectedIndex(0);

        ButtonGroup bg = new ButtonGroup();
        bg.add(vcdRadioBtn);
        bg.add(cdRadioBtn);
        bg.clearSelection();
    }//GEN-LAST:event_clearBtnActionPerformed

    /**
     * @param args the command line arguments
     */

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton addBtn;
    private javax.swing.ButtonGroup buttonGroup1;
    private javax.swing.JComboBox<String> cdCollectionCmb;
    private javax.swing.JLabel cdIdLabel;
    private javax.swing.JTextField cdIdTxt;
    private javax.swing.JLabel cdPriceLabel;
    private javax.swing.JTextField cdPriceTxt;
    private javax.swing.JRadioButton cdRadioBtn;
    private javax.swing.JLabel cdTitleLabel;
    private javax.swing.JTextField cdTitleTxt;
    private javax.swing.JLabel cdTypeLabel;
    private javax.swing.JLabel cdYearLabel;
    private javax.swing.JTextField cdYearTxt;
    private javax.swing.JButton clearBtn;
    private javax.swing.JLabel jLabel4;
    private javax.swing.JButton showBtn;
    private javax.swing.JRadioButton vcdRadioBtn;
    // End of variables declaration//GEN-END:variables
}
